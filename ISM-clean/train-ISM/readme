训练函数
详细信息见函数注释
